\documentclass[10pt,a4paper]{article}
\usepackage[letterpaper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{url}
\usepackage{float}
\geometry{margin=1.8cm}

\usepackage{listings}
\usepackage{xcolor}

\lstdefinestyle{matlabstyle}{
	language=Matlab,
	basicstyle=\ttfamily\small,
	numbers=left,
	numberstyle=\tiny,
	backgroundcolor=\color{gray!5},
	frame=single,
	keywordstyle=\color{blue},
	commentstyle=\color{green!50!black},
	stringstyle=\color{orange},
	breaklines=true
}


\title{Simulation of Mechatronic Systems \\\large Exercise 1 protocol}
\IfFileExists{authors.tex}{
	\input{authors} % this pulls in authors.tex
}{
	\author{please create an authors.tex file}
}

\begin{document}
	\maketitle
	\section*{Exercise 1a): Plotting trigonometric functions}
	
	\begin{figure}[H]
		\includegraphics[width=1.0\linewidth]{1a.pdf}
		\caption{Plots of trigonometric functions.}
		\label{fig:1a}
	\end{figure}
	
	As shown in Figure \ref{fig:1a} above, several trigonometric functions have been plotted into two different figures, one for $sin$, $cos$, $tan$ and one for their corresponding inverse functions. We chose a sufficient linspace $X$ ranging from $-\pi$ to $\pi$ with 100 steps.\newline\newpage\noindent
	\textbf{Matlab Code:}
	
	\lstinputlisting[style=matlabstyle]{../exercise_1_a.m}
	
	\section*{Exercise 1b): Calculating minimum distance between lines in 3D space}
	
	\begin{figure}[H]
		\includegraphics[width=1.0\linewidth]{1b.pdf}
		\caption{Calculated minimum distance between two lines in three dimensional space.}
		\label{fig:1b}
	\end{figure}
	
	Figure \ref{fig:1b} shows the minimum distance between the two lined defined by the four points $A$, $B$, $C$ and $D$.\newline
	At first we can calculate the directional vector for the two straight lines $AB$ and $CD$ as follows:
	\begin{equation}
		\begin{aligned}
			V_1 = B-A \\
			V_2 = D -C
		\end{aligned}
	\end{equation}
	\noindent
	With this we can define the two line equations $L_1(t)$ and $L_2(u)$ as follows:
	
	\begin{equation}
		\begin{aligned}
			L_1(t) = A +t*V_1 \\
			L_2(u) = C +u*V_2
		\end{aligned}
	\end{equation}
	\noindent
	Next up, we define the difference between support vectors $A$ and $C$ as $P_1P_2$ as:
	
	\begin{equation}
		P_1P_2 = C - A
	\end{equation}
	\noindent
	A single solution for the closest approach between two lines exists if they are not parallel. To check this requirement, we have to check if the cross product $n=V_1\times V_2$ between the directional vectors is a vector of nonzero magnitude. Specifically we check if this value is greater than a threshold $\epsilon$, which is a value close to zero because of floating point arithmetic.
	
	\begin{equation}\label{cross_product}
		|n|<\epsilon
	\end{equation}
	\noindent
	Hereby we chose the value $\epsilon=10^{-6}$. If the condition \ref{cross_product} is fulfilled, we can continue on to calculate the values $t_0$ and $u_0$ which correspond to the closest approach of $L_1$ and $L_2$ as follows:
	
	\begin{equation}
		\begin{aligned}
			t_0 = \frac{(V_2\times n)\cdot P_1P_2}{n \cdot n} \\
			u_0 = \frac{(V_1\times n)\cdot P_1P_2}{n \cdot n}
		\end{aligned}
	\end{equation}
	\noindent
	Inserting the values $t_0$ into $L_1(t)$ and $u_0$ into $L_2(u)$ yields the two points which correspond to the closest approach on each line.\newline\newline\noindent
	\textbf{Matlab Code:}
	
	\lstinputlisting[style=matlabstyle]{../exercise_1_b.m}
	\newpage
	\section*{Exercise 1c): Bode and step plots for two functions}
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.8\linewidth]{1cBode1.pdf}
		\caption{Bode diagram for $G_{PT1}$}
		\label{fig:1cBode1}
	\end{figure}
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.8\linewidth]{1cStep1.pdf}
		\caption{Step response for $G_{PT1}$}
		\label{fig:1cStep1}
	\end{figure}
	
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.8\linewidth]{1cBode2.pdf}
		\caption{Bode diagram for $G_{PT2}$}
		\label{fig:1cBode2}
	\end{figure}
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.8\linewidth]{1cStep2.pdf}
		\caption{Step response for $G_{PT2}$}
		\label{fig:1cStep2}
	\end{figure}
	\newpage
	\noindent
	Our first transfer function $G_{PT1}(s)$ can be defined as:
	
	\begin{equation}
		G_{PT1}(s) = \frac{K}{1 + T*s}
	\end{equation}
	\noindent
	The corresponding bode-diagram is displayed in Figure \ref{fig:1cBode1}. Hereby we chose $K$ to be a constant value and eight different values for $T$ ranging from 4 to 25 which yields eight distinct graphs for Magnitude and Phase over frequency. \newline
	The same values for $K$ and $T$ have been chosen in the step response displayed in Figure \ref{fig:1cStep1}. Once again this yields eight distinct graphs for Amplitude over time.
	\newline\newline
	Our second transfer function $G_{PT2}(s)$ can be defined as:
	
	\begin{equation}
		G_{PT2}(s) = \frac{K}{1 + 2dT*s + T^2*s^2}
	\end{equation}
	\noindent
	The corresponding bode-diagram is displayed in Figure \ref{fig:1cBode2}. Hereby we chose $K$ and $d$ to be constants and eight different values for $T$ ranging from 0.4 to 3.2 which yields eight distinct graphs for Magnitude and Phase over frequency. \newline
	The same values for $K$, $d$ and $T$ have been chosen in the step response displayed in Figure \ref{fig:1cStep2}. Once again this yields eight distinct graphs for Amplitude over time.
	\newline\newline\noindent
	\textbf{Matlab Code:}
	\lstinputlisting[style=matlabstyle]{../exercise_1_c.m}
	\newpage
	\section*{Exercise 1e): Building our own function for plotting bode diagrams}
	As there is no d) exercise, we continue on to exercise e).
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.8\linewidth]{1eBuiltinBode.pdf}
		\caption{Bode diagram for transfer function using the builtin bode function}
		\label{fig:1eBuiltinBode}
	\end{figure}
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.8\linewidth]{1eMyBode.pdf}
		\caption{Bode diagram for transfer function using the our own implementation of the bode function}
		\label{fig:1eMyBode}
	\end{figure}
	\newpage
	\noindent
	First of all, we define the transfer function $G(s)$ as follows:
	
	\begin{equation}
		G(s) = \frac{K}{1 + 2Td*s+T^2*s^2}*e^{T_ts}
	\end{equation}
	\noindent
	All parameter values in this equation are constants to be defined as $K=3$, $T_t=0$ and $T=0.4$.
	Using the builtin bode function yields the bode diagram as shown in Figure \ref{fig:1eBuiltinBode}. One graph for Magnitude and Phase over frequency is rendered over a logarithmic scale.\newline
	Similarly, we can insert the transfer function with the set constant parameters into our own defined bode function. This yields the bode diagram as shown in Figure \ref{fig:1eMyBode}. Once again one graph for Magnitude and Phase over frequency is rendered over a logarithmic scale.\newline
	Both implementations seem to yield the same results, at least within the overlapping ranges for frequency which means that our implementation satisfies the requirements.
	\newline\newline\noindent
	\textbf{Matlab Code:}
	
	\lstinputlisting[style=matlabstyle]{../exercise_1_e.m}
\end{document}
